<%= form_with url: pass_path, method: :post do %>
  <% @products.each do |product| %>
    <div>
      <p><%= product.name %></p>
      <button class="bg-indigo-500 bg-cover" type="button" onclick="updateQuantity('<%= product.id %>', -1)">-</button>
      <input type="number" name="products[<%= product.id %>]" id="quantity_<%= product.id %>" value="0" min="0" step="1" >
      <button type="button" onclick="updateQuantity('<%= product.id %>', 1)">+</button>
    </div>    
  <% end %>
  <%= submit_tag "ยืนยัน" %>
<% end %>

<script>
  function updateQuantity(productId, change) {
    const input = document.getElementById(`quantity_${productId}`);
    const currentValue = parseInt(input.value) || 0;
    const newValue = Math.max(0, currentValue + change);
    input.value = newValue;

    const quantities = JSON.parse(sessionStorage.getItem("quantities") || "{}");
    quantities[productId] = newValue;
    sessionStorage.setItem("quantities", JSON.stringify(quantities));
  }

</script>
